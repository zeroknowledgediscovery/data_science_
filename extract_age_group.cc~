#include <iostream>
#include <sstream>
#include <fstream>
#include <string>
#include <stdlib.h>

using namespace std;

const char HDRSEP='^';
const char HSEP='|';

int main(int argc, char* argv[])
{
  string DBfile="";
  int AGEMAX=5,AGEMIN=0;
  
  if (argc>1)
    DBfile=argv[1];
  if (argc>2)
    AGEMAX=atoi(argv[2]);
  if (argc>3)
    AGEMIN=atoi(argv[3]);

  bool OUTPUT_ONLY_ID=false;

  ifstream IN(DBfile.c_str());
  string line;
  while(getline(IN,line))
    {
      stringstream ss(line);
      string hdr;
      if(getline(ss,hdr,HDRSEP))
	{
	  stringstream ssh(hdr);
	  string tok,id;
	  unsigned int count=0;
	  while(getline(ssh,tok,HSEP))
	    {
	      if(count==1)
		{
		  int age=atoi(tok.c_str());
		  if ((age<AGEMAX) && (age>=AGEMIN))
		    {
		      if(OUTPUT_ONLY_ID)
			cout << id << endl;
		      else
			cout << line << endl;
		    }
		  break;
		}
	      else
		id=tok;
	      count++;
	    }
	}
    }

  return 0;
}
